<!DOCTYPE html>
<html lang="en" dir="auto" data-theme="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Lyuxi Liu</title>
<meta name="keywords" content="">
<meta name="description" content="&lt;!doctype html&gt;


  
  
  符號學與結構主義知識圖譜 | Semiotics & Structuralism Graph

  
  
  

  

  


  
    
      
        ⟲ 重置視圖
        ✺ 展開全部

        
          
          EN
        
      
      
    

    
      
        等待選擇
        點擊節點探索

        
          ID
          —
        

        
          歡迎使用符號學與結構主義知識圖譜。
          
          • 單擊節點：展開相關聯的概念。
          
          • 拖拽畫布：自由移動視圖。
          
          • 滾輪縮放：查看局部或全貌。
        
      

      Tip: 再次點擊已選中的節點可聚焦查看其連接
    
  

  

">
<meta name="author" content="">
<link rel="canonical" href="https://llspublic.github.io/projects/topology-of-theory/bilingual_palette_glass/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.343cc480b9ffc8f04ccbe5e968ad674880cab773ec19905e93033065c1e7a804.css" integrity="sha256-NDzEgLn/yPBMy&#43;XpaK1nSIDKt3PsGZBekwMwZcHnqAQ=" rel="preload stylesheet" as="style">
<link rel="icon" href="https://llspublic.github.io/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="https://llspublic.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://llspublic.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://llspublic.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://llspublic.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="https://llspublic.github.io/projects/topology-of-theory/bilingual_palette_glass/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
                color-scheme: dark;
            }

            .list {
                background: var(--theme);
            }

            .toc {
                background: var(--entry);
            }
        }

        @media (prefers-color-scheme: light) {
            .list::-webkit-scrollbar-thumb {
                border-color: var(--code-bg);
            }
        }

    </style>
</noscript>
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.querySelector("html").dataset.theme = 'dark';
    } else if (localStorage.getItem("pref-theme") === "light") {
       document.querySelector("html").dataset.theme = 'light';
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.querySelector("html").dataset.theme = 'dark';
    } else {
        document.querySelector("html").dataset.theme = 'light';
    }

</script><meta property="og:url" content="https://llspublic.github.io/projects/topology-of-theory/bilingual_palette_glass/">
  <meta property="og:site_name" content="Lyuxi Liu">
  <meta property="og:title" content="Lyuxi Liu">
  <meta property="og:description" content="&lt;!doctype html&gt; 符號學與結構主義知識圖譜 | Semiotics &amp; Structuralism Graph ⟲ 重置視圖 ✺ 展開全部 EN 等待選擇 點擊節點探索 ID — 歡迎使用符號學與結構主義知識圖譜。 • 單擊節點：展開相關聯的概念。 • 拖拽畫布：自由移動視圖。 • 滾輪縮放：查看局部或全貌。 Tip: 再次點擊已選中的節點可聚焦查看其連接 ">
  <meta property="og:locale" content="zh-cn">
  <meta property="og:type" content="article">
    <meta property="article:section" content="projects">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="">
<meta name="twitter:description" content="&lt;!doctype html&gt;


  
  
  符號學與結構主義知識圖譜 | Semiotics & Structuralism Graph

  
  
  

  

  


  
    
      
        ⟲ 重置視圖
        ✺ 展開全部

        
          
          EN
        
      
      
    

    
      
        等待選擇
        點擊節點探索

        
          ID
          —
        

        
          歡迎使用符號學與結構主義知識圖譜。
          
          • 單擊節點：展開相關聯的概念。
          
          • 拖拽畫布：自由移動視圖。
          
          • 滾輪縮放：查看局部或全貌。
        
      

      Tip: 再次點擊已選中的節點可聚焦查看其連接
    
  

  

">


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Projects",
      "item": "https://llspublic.github.io/projects/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "",
      "item": "https://llspublic.github.io/projects/topology-of-theory/bilingual_palette_glass/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "",
  "name": "",
  "description": "\u003c!doctype html\u003e 符號學與結構主義知識圖譜 | Semiotics \u0026 Structuralism Graph ⟲ 重置視圖 ✺ 展開全部 EN 等待選擇 點擊節點探索 ID — 歡迎使用符號學與結構主義知識圖譜。 • 單擊節點：展開相關聯的概念。 • 拖拽畫布：自由移動視圖。 • 滾輪縮放：查看局部或全貌。 Tip: 再次點擊已選中的節點可聚焦查看其連接 ",
  "keywords": [
    
  ],
  "articleBody": "\u003c!doctype html\u003e 符號學與結構主義知識圖譜 | Semiotics \u0026 Structuralism Graph ⟲ 重置視圖 ✺ 展開全部 EN 等待選擇 點擊節點探索 ID — 歡迎使用符號學與結構主義知識圖譜。 • 單擊節點：展開相關聯的概念。 • 拖拽畫布：自由移動視圖。 • 滾輪縮放：查看局部或全貌。 Tip: 再次點擊已選中的節點可聚焦查看其連接 ",
  "wordCount" : "26",
  "inLanguage": "en",
  "datePublished": "0001-01-01T00:00:00Z",
  "dateModified": "0001-01-01T00:00:00Z",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://llspublic.github.io/projects/topology-of-theory/bilingual_palette_glass/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Lyuxi Liu",
    "logo": {
      "@type": "ImageObject",
      "url": "https://llspublic.github.io/favicon.ico"
    }
  }
}
</script>
</head>
<body id="top">
    <header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://llspublic.github.io/" accesskey="h" title="Lyuxi Liu (Alt + H)">Lyuxi Liu</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)" aria-label="Toggle theme">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://llspublic.github.io/about/" title="About">
                    <span>About</span>
                </a>
            </li>
            <li>
                <a href="https://llspublic.github.io/publications/" title="Publications">
                    <span>Publications</span>
                </a>
            </li>
            <li>
                <a href="https://llspublic.github.io/projects/" title="Projects">
                    <span>Projects</span>
                </a>
            </li>
            <li>
                <a href="https://llspublic.github.io/essays/" title="Essays">
                    <span>Essays</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      
    </h1>
    <div class="post-meta">

</div>
  </header> 
  <div class="post-content"><!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>符號學與結構主義知識圖譜 | Semiotics & Structuralism Graph</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;700&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">

  <style>
    :root {
      --bg-color: #fcfdfd;
      --sidebar-bg: rgba(255, 255, 255, 0.95);
      --text-main: #0f172a;
      --text-sub: #64748b;
      --border-color: #e2e8f0;
      --shadow-soft: 0 4px 20px rgba(0,0,0,0.06);
      --shadow-hover: 0 4px 12px rgba(0,0,0,0.1);

      /* ===== Palette (choose A or B) =====
         Current: Scheme B (6 colors, better for multi-type nodes)
      */
      --p-primary: #108B96;    /* 法翠 */
      --p-focus: #006D87;      /* 软翠 */
      --p-secondary: #6CABAF;  /* 正青 */
      --p-info: #75C1C4;       /* 松石 */
      --p-bg-accent: #2B6868;  /* 吉翠 */
      --p-muted: #5A4A4E;      /* 天水碧 (as given) */
    }

    * { box-sizing: border-box; }

    html, body {
      height: 100%;
      margin: 0;
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Noto Sans SC", sans-serif;
      background-color: var(--bg-color);
      color: var(--text-main);
      overflow: hidden;
    }

    #app {
      display: flex;
      height: 100%;
      width: 100%;
      position: relative;
    }

    /* Graph area */
    #cy-container {
      flex: 1;
      position: relative;
      background: radial-gradient(#eef2f6 1px, transparent 1px);
      background-size: 24px 24px;
    }

    #cy {
      width: 100%;
      height: 100%;
    }

    /* Floating toolbar */
    #toolbar {
      position: absolute;
      top: 20px;
      left: 20px;
      z-index: 10;
      display: flex;
      gap: 10px;
      background: #fff;
      padding: 8px 10px;
      border-radius: 50px;
      box-shadow: var(--shadow-soft);
      border: 1px solid var(--border-color);
      transition: all 0.3s ease;
    }

    #toolbar:hover {
      box-shadow: var(--shadow-hover);
    }

    button {
      background: transparent;
      border: none;
      font-size: 13px;
      font-weight: 600;
      color: var(--text-main);
      cursor: pointer;
      padding: 6px 14px;
      border-radius: 20px;
      transition: background 0.2s, color 0.2s;
      white-space: nowrap;
    }

    button:hover {
      background: #f1f5f9;
    }

    button:active {
      background: #e2e8f0;
    }

    .lang-pill {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid var(--border-color);
      background: #fff;
    }
    .lang-dot {
      width: 8px;
      height: 8px;
      border-radius: 999px;
      background: var(--p-primary);
    }
    #btnLang {
      color: var(--p-focus);
      font-weight: 700;
    }

    /* Sidebar */
    #side {
      width: 380px;
      height: 100%;
      background: var(--sidebar-bg);
      border-left: 1px solid var(--border-color);
      padding: 30px;
      overflow-y: auto;
      box-shadow: -4px 0 24px rgba(0,0,0,0.02);
      backdrop-filter: blur(10px);
      display: flex;
      flex-direction: column;
      z-index: 20;
    }

    #side h2 {
      font-family: 'Noto Serif SC', serif;
      font-size: 24px;
      margin: 0 0 16px 0;
      line-height: 1.3;
      color: #1e293b;
      border-bottom: 2px solid #f1f5f9;
      padding-bottom: 12px;
    }

    .meta-tag {
      display: inline-block;
      padding: 4px 10px;
      border-radius: 6px;
      font-size: 12px;
      font-weight: 700;
      letter-spacing: 0.5px;
      text-transform: uppercase;
      margin-bottom: 16px;
      background: #f1f5f9;
      color: var(--text-sub);
    }

    .prop-row {
      display: flex;
      font-size: 13px;
      margin-bottom: 8px;
      color: var(--text-sub);
    }
    .prop-label {
      width: 60px;
      font-weight: 700;
      color: #94a3b8;
    }

    .summary-box {
      margin-top: 20px;
      font-size: 15px;
      line-height: 1.7;
      color: #334155;
      background: #f8fafc;
      padding: 16px;
      border-radius: 10px;
      border-left: 4px solid var(--border-color);
    }

    #hint {
      margin-top: auto;
      font-size: 12px;
      color: #94a3b8;
      text-align: center;
      padding-top: 20px;
      border-top: 1px dashed var(--border-color);
    }

    @media (max-width: 768px) {
      #app { flex-direction: column; }
      #side { width: 100%; height: 35%; border-left: none; border-top: 1px solid var(--border-color); }
    }
  
    /* =========================
       Glassmorphism (Clear)
       ========================= */
    :root{
      --glass-bg: rgba(255,255,255,0.16);
      --glass-bg-strong: rgba(255,255,255,0.22);
      --glass-border: rgba(255,255,255,0.34);
      --glass-highlight: rgba(255,255,255,0.55);
      --glass-shadow: 0 14px 40px rgba(0,0,0,0.14);
      --glass-shadow-hover: 0 18px 50px rgba(0,0,0,0.18);
      --glass-blur: 20px;
      --glass-radius: 18px;
    }

    html, body{
      background:
        radial-gradient(1200px 900px at 12% 8%, rgba(117,193,196,0.30), transparent 55%),
        radial-gradient(900px 700px at 86% 14%, rgba(16,139,150,0.22), transparent 60%),
        radial-gradient(900px 700px at 55% 92%, rgba(43,104,104,0.18), transparent 55%),
        linear-gradient(180deg, rgba(252,253,253,1), rgba(246,252,252,1));
      background-attachment: fixed;
    }

    /* Graph area: keep grid, but soften it */
    #cy-container{
      background:
        radial-gradient(1000px 700px at 20% 30%, rgba(108,171,175,0.18), transparent 60%),
        radial-gradient(900px 700px at 78% 68%, rgba(0,109,135,0.12), transparent 62%),
        radial-gradient(rgba(15,23,42,0.06) 1px, transparent 1px);
      background-size: auto, auto, 26px 26px;
    }

    /* Glass panels */
    #toolbar, #side{
      position: relative;
      background: linear-gradient(135deg, var(--glass-bg), rgba(255,255,255,0.06));
      border: 1px solid var(--glass-border);
      border-radius: var(--glass-radius);
      box-shadow: var(--glass-shadow);
      backdrop-filter: blur(var(--glass-blur)) saturate(150%);
      -webkit-backdrop-filter: blur(var(--glass-blur)) saturate(150%);
    }

    #toolbar{ border-radius: 999px; }

    #toolbar:hover{ box-shadow: var(--glass-shadow-hover); }

    /* Sidebar stays rectangular on the inside but glass on the surface */
    #side{
      border-left: 1px solid var(--glass-border);
      box-shadow: -10px 0 34px rgba(0,0,0,0.06);
    }

    #toolbar::before, #side::before{
      content:"";
      position:absolute;
      inset:0;
      border-radius: inherit;
      pointer-events:none;
      background: linear-gradient(180deg, var(--glass-highlight), rgba(255,255,255,0.00) 46%);
      opacity: 0.55;
      mix-blend-mode: screen;
    }

    /* Buttons: subtle glass pills */
    button{
      background: rgba(255,255,255,0.10);
      border: 1px solid rgba(255,255,255,0.22);
      box-shadow: 0 10px 22px rgba(0,0,0,0.08);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
    }
    button:hover{
      background: rgba(255,255,255,0.16);
      color: var(--text-main);
    }

    /* Make tags slightly glassy too */
    .meta-tag{
      background: rgba(255,255,255,0.18);
      border: 1px solid rgba(255,255,255,0.22);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
    }

  </style>

  <script src="https://unpkg.com/cytoscape/dist/cytoscape.min.js"></script>
</head>
<body>
  <div id="app">
    <div id="cy-container">
      <div id="toolbar">
        <button id="btnReset">⟲ 重置視圖</button>
        <button id="btnExpandAll">✺ 展開全部</button>

        <span class="lang-pill" title="Language">
          <span class="lang-dot"></span>
          <button id="btnLang">EN</button>
        </span>
      </div>
      <div id="cy"></div>
    </div>

    <aside id="side">
      <div id="content-wrap" style="opacity: 0.5; transition: opacity 0.3s;">
        <span class="meta-tag" id="type-tag">等待選擇</span>
        <h2 id="title">點擊節點探索<a hidden class="anchor" aria-hidden="true" href="#title">#</a></h2>

        <div class="prop-row">
          <span class="prop-label" id="lblId">ID</span>
          <span id="node-id">—</span>
        </div>

        <div class="summary-box" id="summary">
          歡迎使用符號學與結構主義知識圖譜。
          <br><br>
          • <b>單擊節點</b>：展開相關聯的概念。
          <br>
          • <b>拖拽畫布</b>：自由移動視圖。
          <br>
          • <b>滾輪縮放</b>：查看局部或全貌。
        </div>
      </div>

      <div id="hint">Tip: 再次點擊已選中的節點可聚焦查看其連接</div>
    </aside>
  </div>

  <script>
  // =========================
  // 0) Global language state
  // =========================
  let currentLang = "zh"; // "zh" | "en"

  // UI strings (bilingual)
  const UI = {
    zh: {
      btnReset: "⟲ 重置視圖",
      btnExpandAll: "✺ 展開全部",
      btnLang: "EN",
      typeWaiting: "等待選擇",
      titleHint: "點擊節點探索",
      intro: `歡迎使用符號學與結構主義知識圖譜。<br><br>
              • <b>單擊節點</b>：展開相關聯的概念。<br>
              • <b>拖拽畫布</b>：自由移動視圖。<br>
              • <b>滾輪縮放</b>：查看局部或全貌。`,
      tip: "Tip: 再次點擊已選中的節點可聚焦查看其連接",
      unknown: "未知類型",
      noSummary: "<i>暫無詳細描述...</i>",
      lblId: "ID"
    },
    en: {
      btnReset: "⟲ Reset view",
      btnExpandAll: "✺ Expand all",
      btnLang: "中文",
      typeWaiting: "Waiting",
      titleHint: "Click a node to explore",
      intro: `Welcome to the Semiotics & Structuralism knowledge graph.<br><br>
              • <b>Click a node</b>: expand connected concepts.<br>
              • <b>Drag canvas</b>: pan the view.<br>
              • <b>Scroll</b>: zoom in/out.`,
      tip: "Tip: Click the selected node again to focus on its connections",
      unknown: "Unknown type",
      noSummary: "<i>No details yet...</i>",
      lblId: "ID"
    }
  };

  // =========================
  // 1) Data layer (bilingual)
  // =========================
  const ALL_NODES = [
  {
    "id": "semiotics",
    "label_zh": "符號學",
    "label_en": "Semiotics",
    "type_zh": "概念",
    "type_en": "Concept",
    "summary_zh": "研究各種符號系統；與結構主義關係密切，但研究可不採用結構主義方法。",
    "summary_en": "Studies sign systems of all kinds; closely related to structuralism, but not limited to structuralist methods."
  },
  {
    "id": "overview",
    "label_zh": "概況",
    "label_en": "Overview",
    "type_zh": "結構",
    "type_en": "Structure",
    "summary_zh": "符號學與結構主義聯繫很深，但結構主義範圍遠不止符號學。",
    "summary_en": "Semiotics is deeply tied to structuralism, but structuralism extends well beyond semiotics."
  },
  {
    "id": "structuralism",
    "label_zh": "結構主義",
    "label_en": "Structuralism",
    "type_zh": "理論",
    "type_en": "Theory",
    "summary_zh": "一種不僅限於符號學的方法論，強調系統內各要素之間的關係大於要素本身。",
    "summary_en": "A methodology not confined to semiotics; emphasizes relations among elements over elements themselves."
  },
  {
    "id": "origin",
    "label_zh": "起源",
    "label_en": "Origins",
    "type_zh": "結構",
    "type_en": "Structure",
    "summary_zh": "起源於古希腊；現代符號學由索緒爾與皮爾士從不同角度創立。",
    "summary_en": "Rooted in Ancient Greece; modern semiotics was founded from different angles by Saussure and Peirce."
  },
  {
    "id": "ancient_greece",
    "label_zh": "古希腊",
    "label_en": "Ancient Greece",
    "type_zh": "歷史",
    "type_en": "History",
    "summary_zh": "符號學起源地。",
    "summary_en": "Commonly cited as an origin point for semiotic thinking."
  },
  {
    "id": "saussure",
    "label_zh": "索緒爾",
    "label_en": "Ferdinand de Saussure",
    "type_zh": "人物",
    "type_en": "Person",
    "summary_zh": "瑞士語言學家，從語言學角度創立現代符號學。",
    "summary_en": "Swiss linguist; founded modern semiotics from a linguistic perspective."
  },
  {
    "id": "peirce",
    "label_zh": "皮爾士",
    "label_en": "Charles Sanders Peirce",
    "type_zh": "人物",
    "type_en": "Person",
    "summary_zh": "美國哲學家，從邏輯學角度創立現代符號學；提出符號分類。",
    "summary_en": "American philosopher; founded modern semiotics from logic; proposed key sign classifications."
  },
  {
    "id": "cassirer",
    "label_zh": "卡西爾",
    "label_en": "Ernst Cassirer",
    "type_zh": "人物",
    "type_en": "Person",
    "summary_zh": "使符號學在文藝學領域產生影響；提出“符號形式的哲學”，強調人是“符號動物”。",
    "summary_en": "Brought semiotics into the humanities; proposed the philosophy of symbolic forms and the idea of humans as 'symbolic animals'."
  },
  {
    "id": "langer",
    "label_zh": "蘇珊·朗格",
    "label_en": "Susanne Langer",
    "type_zh": "人物",
    "type_en": "Person",
    "summary_zh": "使符號學在文藝學領域產生影響；提出藝術符號分類。",
    "summary_en": "Influential in arts/humanities; proposed classifications of artistic signs."
  },
  {
    "id": "eco",
    "label_zh": "艾柯",
    "label_en": "Umberto Eco",
    "type_zh": "人物",
    "type_en": "Person",
    "summary_zh": "將符號與特定文化意識形態內涵聯繫。",
    "summary_en": "Linked signs to specific cultural and ideological contents."
  },
  {
    "id": "lotman",
    "label_zh": "尤里·勞特曼",
    "label_en": "Yuri Lotman",
    "type_zh": "人物",
    "type_en": "Person",
    "summary_zh": "塔爾圖學派代表人物；代表作《詩文本的分析》(1972)；強調詩文本信息飽和等。",
    "summary_en": "Key figure of the Tartu school; wrote *The Structure of the Artistic Text* / *Analysis of the Poetic Text* (1972); emphasized information density in poetic texts."
  },
  {
    "id": "range",
    "label_zh": "範圍",
    "label_en": "Scope",
    "type_zh": "結構",
    "type_en": "Structure",
    "summary_zh": "包括語言、藝術、圖像等符號系統；例如詩、鳥語、交通信號。",
    "summary_en": "Covers sign systems such as language, art, and images; e.g., poetry, birdsong, traffic signals."
  },
  {
    "id": "language",
    "label_zh": "語言",
    "label_en": "Language",
    "type_zh": "領域",
    "type_en": "Domain",
    "summary_zh": "符號學研究範圍之一。",
    "summary_en": "One domain studied in semiotics."
  },
  {
    "id": "art",
    "label_zh": "藝術",
    "label_en": "Art",
    "type_zh": "領域",
    "type_en": "Domain",
    "summary_zh": "符號學研究範圍之一。",
    "summary_en": "One domain studied in semiotics."
  },
  {
    "id": "image",
    "label_zh": "圖像",
    "label_en": "Image",
    "type_zh": "領域",
    "type_en": "Domain",
    "summary_zh": "符號學研究範圍之一。",
    "summary_en": "One domain studied in semiotics."
  },
  {
    "id": "poetry",
    "label_zh": "詩",
    "label_en": "Poetry",
    "type_zh": "系統",
    "type_en": "System",
    "summary_zh": "符號系統例子之一。",
    "summary_en": "An example of a sign system."
  },
  {
    "id": "birdsong",
    "label_zh": "鳥語",
    "label_en": "Birdsong",
    "type_zh": "系統",
    "type_en": "System",
    "summary_zh": "符號系統例子之一。",
    "summary_en": "An example of a sign system."
  },
  {
    "id": "traffic_signals",
    "label_zh": "交通信號",
    "label_en": "Traffic Signals",
    "type_zh": "系統",
    "type_en": "System",
    "summary_zh": "符號系統例子之一。",
    "summary_en": "An example of a sign system."
  },
  {
    "id": "langer_art_signs",
    "label_zh": "藝術符號三類",
    "label_en": "Three Types of Artistic Signs",
    "type_zh": "分類",
    "type_en": "Classification",
    "summary_zh": "朗格將藝術符號分為視覺、聽覺、視聽三類。",
    "summary_en": "Langer classifies artistic signs into visual, auditory, and audiovisual types."
  },
  {
    "id": "visual",
    "label_zh": "視覺（繪畫/雕塑/建築）",
    "label_en": "Visual (Painting/Sculpture/Architecture)",
    "type_zh": "分類項",
    "type_en": "Category",
    "summary_zh": "視覺藝術符號：繪畫、雕塑、建築。",
    "summary_en": "Visual artistic signs: painting, sculpture, architecture."
  },
  {
    "id": "auditory",
    "label_zh": "聽覺（音樂）",
    "label_en": "Auditory (Music)",
    "type_zh": "分類項",
    "type_en": "Category",
    "summary_zh": "聽覺藝術符號：音樂。",
    "summary_en": "Auditory artistic signs: music."
  },
  {
    "id": "audiovisual",
    "label_zh": "視聽（舞蹈）",
    "label_en": "Audiovisual (Dance)",
    "type_zh": "分類項",
    "type_en": "Category",
    "summary_zh": "視聽藝術符號：舞蹈。",
    "summary_en": "Audiovisual artistic signs: dance."
  },
  {
    "id": "peirce_icon",
    "label_zh": "圖像的（Icon）",
    "label_en": "Iconic (Icon)",
    "type_zh": "分類項",
    "type_en": "Category",
    "summary_zh": "與所指對象相似，如照片。",
    "summary_en": "Resembles its object, e.g., a photograph."
  },
  {
    "id": "peirce_index",
    "label_zh": "索引的（Index）",
    "label_en": "Indexical (Index)",
    "type_zh": "分類項",
    "type_en": "Category",
    "summary_zh": "與所指對象有聯繫，如煙與火。",
    "summary_en": "Physically/causally connected to its object, e.g., smoke and fire."
  },
  {
    "id": "peirce_symbol",
    "label_zh": "象徵的（Symbol）",
    "label_en": "Symbolic (Symbol)",
    "type_zh": "分類項",
    "type_en": "Category",
    "summary_zh": "任意或約定俗成地與所指相聯繫。",
    "summary_en": "Linked to its object by convention/arbitrariness."
  },
  {
    "id": "cassirer_symbol_forms",
    "label_zh": "符號形式的哲學",
    "label_en": "Philosophy of Symbolic Forms",
    "type_zh": "觀點",
    "type_en": "Viewpoint",
    "summary_zh": "文化由語言、藝術、宗教、科學等符號形式構成；符號連接意識與外部世界。",
    "summary_en": "Culture consists of symbolic forms (language, art, religion, science); symbols connect consciousness to the external world."
  },
  {
    "id": "animal_symbolicum",
    "label_zh": "符號動物（animal symbolicum）",
    "label_en": "Animal Symbolicum",
    "type_zh": "觀點",
    "type_en": "Viewpoint",
    "summary_zh": "卡西爾認為人區別於其他動物在於創造與使用符號的能力。",
    "summary_en": "Cassirer: humans differ from other animals by creating and using symbols."
  },
  {
    "id": "impact",
    "label_zh": "影響",
    "label_en": "Impact",
    "type_zh": "結構",
    "type_en": "Structure",
    "summary_zh": "推動文學批評更嚴格、少依賴印象；也使敘事研究革命化（敘事學）。",
    "summary_en": "Made literary criticism more rigorous and less impressionistic; also revolutionized narrative studies (narratology)."
  },
  {
    "id": "narratology",
    "label_zh": "敘事學",
    "label_en": "Narratology",
    "type_zh": "領域",
    "type_en": "Domain",
    "summary_zh": "結構主義與符號學影響下發展。",
    "summary_en": "Developed under the influence of structuralism and semiotics."
  },
  {
    "id": "lotman_poetic_text",
    "label_zh": "《詩文本的分析》(1972)",
    "label_en": "*Analysis of the Poetic Text* (1972)",
    "type_zh": "作品",
    "type_en": "Work",
    "summary_zh": "勞特曼代表作；討論詩文本分層系統、信息飽和等。",
    "summary_en": "Lotman’s representative work; discusses layered systems and information saturation in poetic text."
  },
  {
    "id": "info_is_beauty",
    "label_zh": "信息就是美",
    "label_en": "Information Is Beauty",
    "type_zh": "觀點",
    "type_en": "Viewpoint",
    "summary_zh": "勞特曼觀點：詩中信息密度與美相關。",
    "summary_en": "Lotman: in poetry, information density correlates with aesthetic effect."
  },
  {
    "id": "prague_school",
    "label_zh": "布拉格學派",
    "label_en": "Prague School",
    "type_zh": "流派",
    "type_en": "School",
    "summary_zh": "20世紀20年代成立的語言學團體，由雅各布遜等人創立。從功能主義角度發展了結構主義，重點研究音位學。",
    "summary_en": "A linguistics circle formed in the 1920s (incl. Jakobson). Developed structuralism through functionalism, with strong focus on phonology."
  },
  {
    "id": "russian_formalism",
    "label_zh": "俄國形式主義",
    "label_en": "Russian Formalism",
    "type_zh": "流派",
    "type_en": "School",
    "summary_zh": "結構主義的前驅之一，主張文學研究應關注形式、技巧和語言結構，而非社會內容。",
    "summary_en": "A precursor to structuralism; argues literary study should focus on form, device, and linguistic structure rather than social content."
  },
  {
    "id": "jakobson",
    "label_zh": "雅各布遜",
    "label_en": "Roman Jakobson",
    "type_zh": "人物",
    "type_en": "Person",
    "summary_zh": "連接俄國形式主義與結構主義的關鍵人物。提出了語言的六種功能以及隱喻/轉喻的對立。",
    "summary_en": "A key bridge between Russian formalism and structuralism. Proposed six functions of language and the metaphor/metonymy opposition."
  },
  {
    "id": "levi_strauss",
    "label_zh": "列維-斯特勞斯",
    "label_en": "Claude Lévi-Strauss",
    "type_zh": "人物",
    "type_en": "Person",
    "summary_zh": "結構主義人類學之父。將語言學模型應用於神話、親屬關係和文化研究，提出“二元對立”。",
    "summary_en": "Founding figure of structural anthropology. Applied linguistic models to myth, kinship, and culture; emphasized binary oppositions."
  },
  {
    "id": "frye",
    "label_zh": "諾思羅普·弗萊",
    "label_en": "Northrop Frye",
    "type_zh": "人物",
    "type_en": "Person",
    "summary_zh": "加拿大文學批評家，其《批評的解剖》構建了宏大的文學原型系統，具有強烈的結構特徵。",
    "summary_en": "Canadian literary critic. In *Anatomy of Criticism*, built a large-scale system of literary archetypes with strong structural features."
  },
  {
    "id": "langue_parole",
    "label_zh": "語言/言語",
    "label_en": "Langue / Parole",
    "type_zh": "概念",
    "type_en": "Concept",
    "summary_zh": "索緒爾的核心區分：語言（Langue）是抽象的規則系統，言語（Parole）是具體的說話行為。",
    "summary_en": "Saussure’s key distinction: langue is the abstract rule system; parole is concrete speech acts."
  },
  {
    "id": "signifier_signified",
    "label_zh": "能指/所指",
    "label_en": "Signifier / Signified",
    "type_zh": "概念",
    "type_en": "Concept",
    "summary_zh": "符號的雙面性：能指是聲音/形象，所指是概念。兩者關係是任意的。",
    "summary_en": "Two-sided sign: signifier (sound/image) and signified (concept). Their link is arbitrary."
  },
  {
    "id": "binary_opposition",
    "label_zh": "二元對立",
    "label_en": "Binary Opposition",
    "type_zh": "概念",
    "type_en": "Concept",
    "summary_zh": "列維-斯特勞斯的方法論核心。認為人類思維通過對立項（如生/熟、男/女）來構建意義。",
    "summary_en": "Methodological core for Lévi-Strauss: human thought constructs meaning through oppositions (e.g., raw/cooked, male/female)."
  },
  {
    "id": "metaphor_metonymy",
    "label_zh": "隱喻與轉喻",
    "label_en": "Metaphor & Metonymy",
    "type_zh": "概念",
    "type_en": "Concept",
    "summary_zh": "雅各布遜提出的語言兩極：隱喻基於相似性（選擇軸），轉喻基於鄰接性（組合軸）。",
    "summary_en": "Jakobson’s two poles: metaphor via similarity (selection axis), metonymy via contiguity (combination axis)."
  },
  {
    "id": "archetype",
    "label_zh": "原型批評",
    "label_en": "Archetypal Criticism",
    "type_zh": "理論",
    "type_en": "Theory",
    "summary_zh": "弗萊主張文學由一系列反復出現的敘事結構（原型）組成，如喜劇、傳奇、悲劇、諷刺對應四季循環。",
    "summary_en": "Frye: literature is composed of recurring narrative structures (archetypes), often mapped to cycles such as the seasons."
  },
  {
    "id": "mytheme",
    "label_zh": "神話素",
    "label_en": "Mytheme",
    "type_zh": "概念",
    "type_en": "Concept",
    "summary_zh": "列維-斯特勞斯仿照“音素”創造的詞，指神話中不可再分的最小意義單元。",
    "summary_en": "Coined by Lévi-Strauss by analogy with 'phoneme': the smallest meaningful unit in myth."
  }
];

  const ALL_EDGES = [
  {
    "id": "e1",
    "source": "semiotics",
    "target": "overview",
    "label_zh": "包含",
    "label_en": "Includes"
  },
  {
    "id": "e2",
    "source": "semiotics",
    "target": "origin",
    "label_zh": "包含",
    "label_en": "Includes"
  },
  {
    "id": "e3",
    "source": "semiotics",
    "target": "range",
    "label_zh": "包含",
    "label_en": "Includes"
  },
  {
    "id": "e4",
    "source": "semiotics",
    "target": "impact",
    "label_zh": "包含",
    "label_en": "Includes"
  },
  {
    "id": "e5",
    "source": "overview",
    "target": "structuralism",
    "label_zh": "相關",
    "label_en": "Related"
  },
  {
    "id": "e6",
    "source": "origin",
    "target": "ancient_greece",
    "label_zh": "起源於",
    "label_en": "Originates in"
  },
  {
    "id": "e7",
    "source": "origin",
    "target": "saussure",
    "label_zh": "創立者",
    "label_en": "Founder"
  },
  {
    "id": "e8",
    "source": "origin",
    "target": "peirce",
    "label_zh": "創立者",
    "label_en": "Founder"
  },
  {
    "id": "e9",
    "source": "origin",
    "target": "cassirer",
    "label_zh": "使產生影響",
    "label_en": "Influenced"
  },
  {
    "id": "e10",
    "source": "origin",
    "target": "langer",
    "label_zh": "使產生影響",
    "label_en": "Influenced"
  },
  {
    "id": "e11",
    "source": "origin",
    "target": "eco",
    "label_zh": "關聯文化意識形態",
    "label_en": "Links to ideology"
  },
  {
    "id": "e12",
    "source": "origin",
    "target": "lotman",
    "label_zh": "關聯文化意識形態",
    "label_en": "Links to ideology"
  },
  {
    "id": "e13",
    "source": "range",
    "target": "language",
    "label_zh": "包括",
    "label_en": "Includes"
  },
  {
    "id": "e14",
    "source": "range",
    "target": "art",
    "label_zh": "包括",
    "label_en": "Includes"
  },
  {
    "id": "e15",
    "source": "range",
    "target": "image",
    "label_zh": "包括",
    "label_en": "Includes"
  },
  {
    "id": "e16",
    "source": "range",
    "target": "poetry",
    "label_zh": "例如",
    "label_en": "For example"
  },
  {
    "id": "e17",
    "source": "range",
    "target": "birdsong",
    "label_zh": "例如",
    "label_en": "For example"
  },
  {
    "id": "e18",
    "source": "range",
    "target": "traffic_signals",
    "label_zh": "例如",
    "label_en": "For example"
  },
  {
    "id": "e19",
    "source": "langer",
    "target": "langer_art_signs",
    "label_zh": "提出",
    "label_en": "Proposes"
  },
  {
    "id": "e20",
    "source": "langer_art_signs",
    "target": "visual",
    "label_zh": "分類",
    "label_en": "Classifies"
  },
  {
    "id": "e21",
    "source": "langer_art_signs",
    "target": "auditory",
    "label_zh": "分類",
    "label_en": "Classifies"
  },
  {
    "id": "e22",
    "source": "langer_art_signs",
    "target": "audiovisual",
    "label_zh": "分類",
    "label_en": "Classifies"
  },
  {
    "id": "e23",
    "source": "peirce",
    "target": "peirce_icon",
    "label_zh": "分類",
    "label_en": "Classifies"
  },
  {
    "id": "e24",
    "source": "peirce",
    "target": "peirce_index",
    "label_zh": "分類",
    "label_en": "Classifies"
  },
  {
    "id": "e25",
    "source": "peirce",
    "target": "peirce_symbol",
    "label_zh": "分類",
    "label_en": "Classifies"
  },
  {
    "id": "e26",
    "source": "cassirer",
    "target": "cassirer_symbol_forms",
    "label_zh": "觀點",
    "label_en": "View"
  },
  {
    "id": "e27",
    "source": "cassirer_symbol_forms",
    "target": "animal_symbolicum",
    "label_zh": "定義人",
    "label_en": "Defines human"
  },
  {
    "id": "e28",
    "source": "impact",
    "target": "narratology",
    "label_zh": "推動",
    "label_en": "Drives"
  },
  {
    "id": "e29",
    "source": "lotman",
    "target": "lotman_poetic_text",
    "label_zh": "代表作",
    "label_en": "Major work"
  },
  {
    "id": "e30",
    "source": "lotman",
    "target": "info_is_beauty",
    "label_zh": "觀點",
    "label_en": "View"
  },
  {
    "id": "e_saussure_1",
    "source": "saussure",
    "target": "langue_parole",
    "label_zh": "提出",
    "label_en": "Proposes"
  },
  {
    "id": "e_saussure_2",
    "source": "saussure",
    "target": "signifier_signified",
    "label_zh": "提出",
    "label_en": "Proposes"
  },
  {
    "id": "e_jakobson_1",
    "source": "structuralism",
    "target": "jakobson",
    "label_zh": "關鍵人物",
    "label_en": "Key figure"
  },
  {
    "id": "e_jakobson_2",
    "source": "jakobson",
    "target": "prague_school",
    "label_zh": "創立",
    "label_en": "Co-founds"
  },
  {
    "id": "e_jakobson_3",
    "source": "jakobson",
    "target": "russian_formalism",
    "label_zh": "關聯",
    "label_en": "Connected to"
  },
  {
    "id": "e_jakobson_4",
    "source": "jakobson",
    "target": "metaphor_metonymy",
    "label_zh": "提出",
    "label_en": "Proposes"
  },
  {
    "id": "e_jakobson_5",
    "source": "jakobson",
    "target": "levi_strauss",
    "label_zh": "深刻影響",
    "label_en": "Influences"
  },
  {
    "id": "e_levi_1",
    "source": "structuralism",
    "target": "levi_strauss",
    "label_zh": "人類學代表",
    "label_en": "Anthropology rep."
  },
  {
    "id": "e_levi_2",
    "source": "levi_strauss",
    "target": "binary_opposition",
    "label_zh": "核心方法",
    "label_en": "Core method"
  },
  {
    "id": "e_levi_3",
    "source": "levi_strauss",
    "target": "mytheme",
    "label_zh": "提出",
    "label_en": "Coins"
  },
  {
    "id": "e_levi_4",
    "source": "saussure",
    "target": "levi_strauss",
    "label_zh": "理論基礎",
    "label_en": "Theoretical basis"
  },
  {
    "id": "e_frye_1",
    "source": "structuralism",
    "target": "frye",
    "label_zh": "關聯(文學)",
    "label_en": "Related (literature)"
  },
  {
    "id": "e_frye_2",
    "source": "frye",
    "target": "archetype",
    "label_zh": "代表理論",
    "label_en": "Key theory"
  },
  {
    "id": "e_con_1",
    "source": "semiotics",
    "target": "signifier_signified",
    "label_zh": "核心機制",
    "label_en": "Core mechanism"
  }
];

  // Index helpers
  const nodeById = new Map(ALL_NODES.map(n => [n.id, n]));
  const edgeById = new Map(ALL_EDGES.map(e => [e.id, e]));
  const adj = new Map();
  for (const e of ALL_EDGES) {
    if (!adj.has(e.source)) adj.set(e.source, []);
    if (!adj.has(e.target)) adj.set(e.target, []);
    adj.get(e.source).push(e.id);
    adj.get(e.target).push(e.id);
  }

  // Initial state
  const INITIAL_NODE_IDS = new Set(["semiotics","overview","origin","range","impact","structuralism"]);
  const shownNodes = new Set(INITIAL_NODE_IDS);
  const shownEdges = new Set();

  function edgeVisible(e) {
    return shownNodes.has(e.source) && shownNodes.has(e.target);
  }

  // =========================
  // 2) Palette mapping
  // =========================
  function getColor(type) {
    // Type values are display values (zh/en), so we normalize by checking bilingual sets.
    const t = (type || "").toLowerCase();
    const isPerson = (type === "人物" || t === "person");
    const isSchool = (type === "流派" || t === "school");
    const isConcept = (type === "概念" || t === "concept");
    const isTheory = (type === "理論" || t === "theory");
    const isStructure = (type === "結構" || t === "structure");
    const isHistory = (type === "歷史" || t === "history");
    const isDomain = (type === "領域" || t === "domain");
    const isSystem = (type === "系統" || t === "system");
    const isClassification = (type === "分類" || t === "classification");
    const isCategory = (type === "分類項" || t === "category");
    const isViewpoint = (type === "觀點" || t === "viewpoint");
    const isWork = (type === "作品" || t === "work");

    // Scheme B mapping (6 colors):
    // - Person / Work = Focus (more "attention")
    // - Theory / Concept = Primary / Secondary
    // - Structure / Domain / System = Info
    // - School / History / Classification / Category / Viewpoint = Muted (to keep them legible but less dominant)
    if (isPerson || isWork) return getComputedStyle(document.documentElement).getPropertyValue("--p-focus").trim();
    if (isTheory) return getComputedStyle(document.documentElement).getPropertyValue("--p-primary").trim();
    if (isConcept) return getComputedStyle(document.documentElement).getPropertyValue("--p-secondary").trim();
    if (isStructure || isDomain || isSystem) return getComputedStyle(document.documentElement).getPropertyValue("--p-info").trim();
    if (isSchool || isHistory || isClassification || isCategory || isViewpoint) return getComputedStyle(document.documentElement).getPropertyValue("--p-muted").trim();

    return getComputedStyle(document.documentElement).getPropertyValue("--p-primary").trim();
  }

  function getShape(type) {
    // Using display types
    const t = (type || "").toLowerCase();
    if (type === "人物" || t === "person") return "ellipse";
    if (type === "作品" || t === "work") return "cut-rectangle";
    if (type === "觀點" || t === "viewpoint" || type === "流派" || t === "school") return "round-diamond";
    return "round-rectangle";
  }

  // =========================
  // 3) Dynamic rendering helpers
  // =========================
  function applyLangToNodeData(rawNode) {
    const langKey = currentLang;
    const label = rawNode["label_" + langKey] ?? rawNode.label_zh ?? rawNode.label_en ?? rawNode.id;
    const type = rawNode["type_" + langKey] ?? rawNode.type_zh ?? rawNode.type_en ?? "";
    const summary = rawNode["summary_" + langKey] ?? rawNode.summary_zh ?? rawNode.summary_en ?? "";
    return {
      ...rawNode,
      label,
      type,
      summary
    };
  }

  function applyLangToEdgeData(rawEdge) {
    const langKey = currentLang;
    const label = rawEdge["label_" + langKey] ?? rawEdge.label_zh ?? rawEdge.label_en ?? "";
    return {
      ...rawEdge,
      label
    };
  }

  function buildElements() {
    const elements = [];
    for (const id of shownNodes) {
      const raw = nodeById.get(id);
      if (raw) elements.push({ data: applyLangToNodeData(raw) });
    }
    for (const e of ALL_EDGES) {
      if (edgeVisible(e)) {
        shownEdges.add(e.id);
        elements.push({ data: applyLangToEdgeData(e) });
      }
    }
    return elements;
  }

  // =========================
  // 4) Cytoscape init
  // =========================
  const cy = cytoscape({
    container: document.getElementById("cy"),
    elements: buildElements(),
    wheelSensitivity: 0.2,
    style: [
      {
        selector: "node",
        style: {
          "label": "data(label)",
          "font-family": "Noto Serif SC, serif",
          "font-size": 14,
          "font-weight": "bold",
          "color": "#fff",
          "text-valign": "center",
          "text-halign": "center",
          "text-wrap": "wrap",
          "text-max-width": 110,
          "text-outline-width": 0,
          "background-color": (ele) => getColor(ele.data("type")),
          "shape": (ele) => getShape(ele.data("type")),
          "width": "label",
          "height": "label",
          "padding": "12px",
          "border-width": 0,
          "shadow-blur": 10,
          "shadow-color": "rgba(0,0,0,0.15)",
          "shadow-offset-y": 4,
          "transition-property": "background-color, line-color, target-arrow-color",
          "transition-duration": "0.25s"
        }
      },
      {
        selector: "edge",
        style: {
          "curve-style": "bezier",
          "width": 2,
          "line-color": "#cbd5e1",
          "target-arrow-shape": "triangle",
          "target-arrow-color": "#cbd5e1",
          "arrow-scale": 0.8,
          "label": "data(label)",
          "font-size": 10,
          "color": "#94a3b8",
          "text-rotation": "autorotate",
          "text-background-color": "#fcfdfd",
          "text-background-opacity": 1,
          "text-background-padding": 2
        }
      },
      {
        selector: ":selected",
        style: {
          "border-width": 4,
          "border-color": "var(--p-focus)",
          "border-opacity": 0.85
        }
      },
      {
        selector: ".faded",
        style: {
          "opacity": 0.15,
          "text-opacity": 0,
          "shadow-opacity": 0
        }
      },
      {
        selector: ".highlight",
        style: {
          "shadow-blur": 22,
          "shadow-color": "rgba(0,0,0,0.22)",
          "z-index": 999
        }
      }
    ],
    layout: {
      name: "cose",
      animate: true,
      animationDuration: 500,
      padding: 50,
      componentSpacing: 60,
      nodeRepulsion: 8000
    }
  });

  let lastSelectedNodeId = null;

  // =========================
  // 5) Interactions
  // =========================
  function expandNode(nodeId) {
    const edgeIds = adj.get(nodeId) || [];
    let added = false;

    cy.batch(() => {
      for (const eid of edgeIds) {
        const eRaw = edgeById.get(eid);
        if (!eRaw) continue;

        [eRaw.source, eRaw.target].forEach(nid => {
          if (!shownNodes.has(nid)) {
            const nRaw = nodeById.get(nid);
            if (nRaw) {
              shownNodes.add(nid);
              cy.add({ data: applyLangToNodeData(nRaw) });
              added = true;
            }
          }
        });

        if (!shownEdges.has(eid) && edgeVisible(eRaw)) {
          shownEdges.add(eid);
          cy.add({ data: applyLangToEdgeData(eRaw) });
        }
      }
    });

    if (added) {
      cy.layout({
        name: "cose",
        animate: true,
        animationDuration: 600,
        padding: 50,
        randomize: false,
        fit: false
      }).run();
    }
  }

  function updateSidebar(node) {
    const wrap = document.getElementById("content-wrap");
    wrap.style.opacity = 1;

    const t = node.data("type") || UI[currentLang].unknown;
    const c = getColor(t);

    const tag = document.getElementById("type-tag");
    tag.textContent = t;
    tag.style.color = c;
    tag.style.background = c + "20";

    document.getElementById("title").textContent = node.data("label") || node.id();
    document.getElementById("node-id").textContent = node.id();
    document.getElementById("summary").innerHTML = node.data("summary") || UI[currentLang].noSummary;

    document.querySelector(".summary-box").style.borderLeftColor = c;
  }

  function focusNode(node) {
    cy.elements().removeClass("faded highlight");
    cy.elements().addClass("faded");
    const neighborhood = node.neighborhood().add(node);
    neighborhood.removeClass("faded").addClass("highlight");
  }

  cy.on("tap", "node", (evt) => {
    const n = evt.target;
    lastSelectedNodeId = n.id();
    updateSidebar(n);
    expandNode(n.id());
    focusNode(n);
  });

  cy.on("tap", (evt) => {
    if (evt.target === cy) {
      cy.elements().removeClass("faded highlight");
      document.getElementById("content-wrap").style.opacity = 0.5;
      lastSelectedNodeId = null;
    }
  });

  document.getElementById("btnReset").addEventListener("click", () => {
    cy.fit(undefined, 50);
    cy.elements().removeClass("faded highlight");
  });

  document.getElementById("btnExpandAll").addEventListener("click", () => {
    const ids = Array.from(shownNodes);
    cy.batch(() => {
      for (const id of ids) expandNode(id);
    });
    cy.layout({ name: "cose", animate: true, padding: 50 }).run();
    setTimeout(() => cy.fit(), 600);
  });

  // Hover cursor
  cy.on('mouseover', 'node', () => { document.body.style.cursor = 'pointer'; });
  cy.on('mouseout', 'node', () => { document.body.style.cursor = 'default'; });

  // =========================
  // 6) Language toggle (one-click)
  // =========================
  function renderUIStrings() {
    const lang = currentLang;
    document.getElementById("btnReset").textContent = UI[lang].btnReset;
    document.getElementById("btnExpandAll").textContent = UI[lang].btnExpandAll;
    document.getElementById("btnLang").textContent = UI[lang].btnLang;
    document.getElementById("hint").textContent = UI[lang].tip;
    document.getElementById("lblId").textContent = UI[lang].lblId;

    // If no node selected, show intro in current language
    if (!lastSelectedNodeId) {
      document.getElementById("type-tag").textContent = UI[lang].typeWaiting;
      document.getElementById("title").textContent = UI[lang].titleHint;
      document.getElementById("summary").innerHTML = UI[lang].intro;
    }
  }

  function applyLangToAllElements() {
    cy.batch(() => {
      // Nodes
      cy.nodes().forEach(n => {
        const raw = nodeById.get(n.id());
        if (!raw) return;
        const data = applyLangToNodeData(raw);
        n.data("label", data.label);
        n.data("type", data.type);
        n.data("summary", data.summary);
        // keep bilingual fields for later toggles
        n.data("label_zh", raw.label_zh); n.data("label_en", raw.label_en);
        n.data("type_zh", raw.type_zh); n.data("type_en", raw.type_en);
        n.data("summary_zh", raw.summary_zh); n.data("summary_en", raw.summary_en);
      });

      // Edges
      cy.edges().forEach(e => {
        const raw = edgeById.get(e.id());
        if (!raw) return;
        const data = applyLangToEdgeData(raw);
        e.data("label", data.label);
        e.data("label_zh", raw.label_zh);
        e.data("label_en", raw.label_en);
      });
    });

    // Refresh sidebar if there is a selected node
    if (lastSelectedNodeId) {
      const n = cy.getElementById(lastSelectedNodeId);
      if (n && n.isNode()) updateSidebar(n);
    }
  }

  document.getElementById("btnLang").addEventListener("click", () => {
    currentLang = (currentLang === "zh") ? "en" : "zh";
    renderUIStrings();
    applyLangToAllElements();
  });

  // Initial render
  renderUIStrings();
  applyLangToAllElements();

  </script>
</body>
</html>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="https://llspublic.github.io/">Lyuxi Liu</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu');
    if (menu) {
        
        const scrollPosition = localStorage.getItem("menu-scroll-position");
        if (scrollPosition) {
            menu.scrollLeft = parseInt(scrollPosition, 10);
        }
        
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        const html = document.querySelector("html");
        if (html.dataset.theme === "dark") {
            html.dataset.theme = 'light';
            localStorage.setItem("pref-theme", 'light');
        } else {
            html.dataset.theme = 'dark';
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
